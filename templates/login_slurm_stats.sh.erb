#/bin/bash

date=$(head -n 1 /usr/local/share/slurm_stats/slurm_stats_fairshare.txt)
fair=$(grep "${USER}|" /usr/local/share/slurm_stats/slurm_stats_fairshare.txt)

if [ -n "$fair" ]
then
  echo ""
  echo "Slurm Stats for ${date}"
  fairshare="End of Day Fairshare |"
  for i in $fair
  do
    account=$(echo ${i} | cut -d '|' -f 2)
    score=$(echo ${i} | cut -d '|' -f 3)
    fairshare="${fairshare} ${account}: ${score} |"
  done
  echo "${fairshare}"

  echo "Core Usage: 500 CPU Hours | Average Number of Cores Used: 1 Allocated: 4 | CPU Efficiency: 50%"
  echo "Average Memory Used: 4GB Allocated: 8GB | Memory Efficiency: 50%"
  echo "GPU Usage: 60 GPU Hours | Average Number of GPUs Used: 0"
  echo "Jobs by State: 4000 Total | 300 Completed | 400 Canceled | 500 Failed | 3000 Out of Memory"
  echo "Average Job Wait Time: 5 hours | Average Job Run Time: 1 day"
fi
